// 1. Config ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Database (Postgres)
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// --------------------------------------------------------
// üë• ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (User Management)
// --------------------------------------------------------

enum Role {
  ADMIN // ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
  EXECUTIVE // ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
  SALES // ‡∏ù‡πà‡∏≤‡∏¢‡∏Ç‡∏≤‡∏¢
  GRAPHIC // ‚ú® ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)
  STOCK // ‡∏ù‡πà‡∏≤‡∏¢‡∏™‡∏ï‡πá‡∏≠‡∏Å/‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  PRODUCTION // ‡∏ù‡πà‡∏≤‡∏¢‡∏ú‡∏•‡∏¥‡∏ï (‡∏õ‡∏±‡∏Å/‡∏™‡∏Å‡∏£‡∏µ‡∏ô)
  SEWING_QC // ‚ú® ‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏±‡∏î‡πÄ‡∏¢‡πá‡∏ö‡πÅ‡∏•‡∏∞ QC (‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏±‡πà‡∏á)
  DELIVERY // ‡∏ù‡πà‡∏≤‡∏¢‡∏à‡∏±‡∏î‡∏™‡πà‡∏á
}

model User {
  id       Int     @id @default(autoincrement())
  username String  @unique
  password String
  name     String
  role     Role    @default(SALES)
  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relation: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ß‡πà‡∏≤ User ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏á‡∏≤‡∏ô‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á
  openedOrders  Order[] @relation("SalesOrders")
  graphicOrders Order[] @relation("GraphicOrders") // ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏≥
  qcOrders      Order[] @relation("QCOrders") // ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà QC ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡∏£‡∏ß‡∏à

  activityLogs ActivityLog[]
  pushSubs     PushSubscription[]
}

// --------------------------------------------------------
// üì¶ ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏á‡∏≤‡∏ô (Order & Job Sheet)
// --------------------------------------------------------

enum OrderStatus {
  PENDING // ‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô/‡∏°‡∏±‡∏î‡∏à‡∏≥
  CONFIRMED // ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡∏±‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß)
  DESIGNING // ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö
  PRODUCTION // ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï (‡∏ï‡∏±‡∏î/‡πÄ‡∏¢‡πá‡∏ö/‡∏™‡∏Å‡∏£‡∏µ‡∏ô)
  PACKING // ‡πÅ‡∏û‡πá‡∏Ñ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  DELIVERY // ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß
  COMPLETED // ‡∏à‡∏ö‡∏á‡∏≤‡∏ô
  CANCELLED // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å)
}

model Order {
  id    Int    @id @default(autoincrement())
  jobId String @unique // ‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏ä‡∏ß‡πå‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô "JOB-6701-001"

  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Customer Info)
  customerName    String
  customerPhone   String?
  customerAddress String? // ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á

  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏á‡∏¥‡∏ô
  totalPrice Decimal @db.Decimal(10, 2) // ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°
  deposit    Decimal @default(0) @db.Decimal(10, 2) // ‡∏°‡∏±‡∏î‡∏à‡∏≥

  // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
  status  OrderStatus @default(PENDING)
  dueDate DateTime? // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô

  // ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏Ç‡∏≤‡∏¢
  salesId Int // ‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏Ñ‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•
  sales   User @relation("SalesOrders", fields: [salesId], references: [id])

  graphicId Int? // ‚ú® ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏´‡∏ô‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö?
  graphic   User? @relation("GraphicOrders", fields: [graphicId], references: [id])

  qcId Int? // ‚ú® QC ‡∏Ñ‡∏ô‡πÑ‡∏´‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡πà‡∏≤‡∏ô?
  qc   User? @relation("QCOrders", fields: [qcId], references: [id])

  // Relations
  items OrderItem[]
  logs  ActivityLog[] // ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Category {
  id       Int       @id @default(autoincrement())
  name     String // ‡πÄ‡∏ä‡πà‡∏ô "‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ä‡πá‡∏≠‡∏õ", "‡πÇ‡∏õ‡πÇ‡∏•", "‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤"
  products Product[]
}

model Product {
  id          Int     @id @default(autoincrement())
  name        String // ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô "‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ä‡πá‡∏≠‡∏õ‡πÅ‡∏Ç‡∏ô‡∏¢‡∏≤‡∏ß A")
  codePrefix  String? // ‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∏‡πà‡∏ô (‡πÄ‡∏ä‡πà‡∏ô "A", "P")
  description String?
  imageUrl    String? // ‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (1 ‡∏£‡∏π‡∏õ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏Å‡∏•‡∏á)

  categoryId Int
  category   Category @relation(fields: [categoryId], references: [id])

  variants ProductVariant[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Gender {
  male
  female
}

model ProductVariant {
  id  Int    @id @default(autoincrement())
  sku String @unique // ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡πâ‡∏≤‡∏°‡∏ã‡πâ‡∏≥ (‡πÄ‡∏ä‡πà‡∏ô "A101-M")

  // ‡∏™‡πÄ‡∏õ‡∏Ñ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏ô CSV)
  code   String // ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏ö‡∏ö/‡∏™‡∏µ (‡πÄ‡∏ä‡πà‡∏ô "A101")
  color  String // ‡∏™‡∏µ (‡πÄ‡∏ä‡πà‡∏ô "‡∏Å‡∏£‡∏°‡∏ó‡πà‡∏≤")
  size   String // ‡πÑ‡∏ã‡∏™‡πå (‡πÉ‡∏™‡πà‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏î‡∏ó‡∏±‡πâ‡∏á "M", "40", "Free Size")
  gender Gender @default(male)

  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡πá‡∏≠‡∏Å
  price Decimal @db.Decimal(10, 2) // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢
  cost  Decimal @default(0) @db.Decimal(10, 2) // ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÅ‡∏î‡∏á)

  stock    Int     @default(0) // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á
  minStock Int     @default(5) // ‚ú® ‡∏à‡∏∏‡∏î‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Low Stock Alert)
  location String? // ‚ú® ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô "‡∏ä‡∏±‡πâ‡∏ô 2 ‡∏•‡πá‡∏≠‡∏Å A")

  productId Int
  product   Product @relation(fields: [productId], references: [id])

  orderItems OrderItem[]
}

// ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ö‡∏ö)
model OrderItem {
  id      Int   @id @default(autoincrement())
  orderId Int
  order   Order @relation(fields: [orderId], references: [id])

  // -------------------------------------------------------
  // ‚úÖ ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÇ‡∏Å‡∏î‡∏±‡∏á (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å)
  // -------------------------------------------------------
  variantId Int
  variant   ProductVariant @relation(fields: [variantId], references: [id])

  // -------------------------------------------------------
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Snapshot (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠)
  // -------------------------------------------------------
  productName String // ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠)
  price       Decimal @db.Decimal(10, 2) // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤)
  quantity    Int // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠

  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏¥‡πÄ‡∏®‡∏© (JSON) ‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏™‡∏Å‡∏£‡∏µ‡∏ô, ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå Artwork
  details Json?
}

// --------------------------------------------------------
// üìä ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Tracking & Notification)
// --------------------------------------------------------

// ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡πà‡∏≤ "‡πÉ‡∏Ñ‡∏£ ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà" (Audit Trail)
model ActivityLog {
  id      Int     @id @default(autoincrement())
  action  String // ‡πÄ‡∏ä‡πà‡∏ô "‡∏ï‡∏±‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏•‡∏¥‡∏ï", "‡πÅ‡∏Å‡πâ‡∏ö‡∏¥‡∏•"
  details String? // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

  orderId Int?
  order   Order? @relation(fields: [orderId], references: [id])

  userId Int
  user   User @relation(fields: [userId], references: [id])

  timestamp DateTime @default(now())
}

// ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏Å‡πá‡∏ö Token ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏¥‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (Web Push)
model PushSubscription {
  id       Int    @id @default(autoincrement())
  endpoint String // URL ‡∏Ç‡∏≠‡∏á Google/Apple Push Service
  keys     Json // ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ (p256dh, auth)

  userId Int
  user   User @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())
}
